<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.campass.demo.dao.PdtCartDao">
	
	<!-- 장바구니 추가 -->
	<insert id="pAddCart">
		<selectKey keyProperty="pdtCartNo" resultType="int" order="BEFORE">
			select nvl(max(pdtCartNo), 0)+1 from PdtCart
			<!-- select board_seq.nextval from dual -->
		</selectKey>
		insert into PdtCart(pdtCartNo, pdtCartAmo, bId, pCode)
		 values(#{pdtCartNo}, #{pdtCartAmo}, #{bId}, #{pCode})
	</insert>

	<!--  장바구니 삭제 -->
	<delete id="cartAllDelete">
		 	delete from pdtCart where pdtCartNo=#{pdtCartNo}
	</delete>
	
	<!-- 수량변경 test필요!  -->
	<update id="pCartAmoUpdate">
		update PdtCart set pdtCartAmo=#{pdtCartAmo} where pdtCartNo = #{pdtCartNo}
	</update>
	
	<!-- 장바구니 리스트 -->
	<select id="listCart" resultType="com.campass.demo.dto.PdtCartDto$Read">
		select a.pdtcartNo, a.bId, a.pCode, a.pdtcartAmo, b.pName, b.pPrice
		from PdtCart a left outer join product b on a.pCode = b.pCode
		where bId=#{bId}
	</select>
</mapper>
