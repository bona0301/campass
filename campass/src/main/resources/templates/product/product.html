<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<title>product</title>
<link href="https://ifh.cc/g/NdOrVp.png" rel="icon">
    <link rel="stylesheet" href="/css/product/common.css">
    <link rel="stylesheet" href="/css/product/main.css">
    
	<script src="/js/product/gsap.js"></script>
	<script src="/js/product/scrollTrigger.js"></script>
	<script src="/js/product/scrollbar.js"></script>
	<script src="/js/product/setting.js"></script>
	<script src="/js/product/main.js"></script>  
	
		<style>
		.pagination {
			display: flex;
			justify-content: center;
		}

		.pagination li {
			display: none;
		}
	</style>
<script>
	// 페이징
	function getPageno(){
		const params = new URLSearchParams(location.search);
		const pageno = params.get("pageno");
		if(pageno==null)
			return 1;
		if(isNaN(pageno))
			return 1;
		if(pageno<1)
			return 1;
		return pageno;
	}
	
	// 글출력 - <template> 사용
	function printProductList(productList){
		const $list = $('#list');
		const $t = $('#tr_template').html();
		for(const p of productList) {
			$list.append($t.replace('{pCode1}',p.pCode).replace('{pCode2}',p.pCode).replace('{pmainImg}',p.pmainImg).replace('{pName}',p.pName)
					.replace('{pPrice}'));
		}
	}
	
	// 페이징 계산
	function getPagination({pageno, pagesize, totalcount, blocksize=4}){
		const countOfPage = Math.ceil(totalcount/pagesize);
		const prev = Math.floor((pageno-1)/blocksize)*blocksize;
		let end = prev + blocksize;
		const start = prev + 1;
		/* let end = prev +  */
		let next = end + 1;
		if(end>=countOfPage){
			end = countOfPage;
			next = 0;
		}
		return {pageno, prev, start, end, next};
	}
	
	// pagination 출력
	function printPagination({pageno, prev, start, end, next}){
		if (prev > 0)
			$('#prev').css('display', 'block').children('a').attr("href", "/product?pageno=" + prev);
		if (next > 0)
			$('#next').css('display', 'block').children('a').attr("href", "/product?pageno=" + next);

		
		const pagination_li = $('.pagination li');
		for(let i = start; i<=end; i++){
			const $li = $(pagination_li[i]);
			$li.css('display','block').children('a').attr("href", "/product?pageno"+i).text(i);
			if(i===pageno)
				$li.addClass('active');
		}
	}
	
	 $(document).ready(async function () {
		const apiUrl = 'http://localhost:8087/product';
		const pageno = getPageno();
		const params = {pageno};
		$.ajax({url: apiUrl, data: params}).done((response)=>{
			printBoardList(response.result.printBoardList);
			const pagination = getPagination(response.result);
			printPagination(pagination);
		}).fail((error)=>{
			console.log(error);
		});			
	}) 
</script>
</head>
<body>
<!-- 로고 -->
<h1 class="logo">
    <img src="https://ifh.cc/g/qzoPtk.png" width="120px" alt="캠패스_핑크로고">
</h1>
<!-- 로고 끝 -->

<!-- 메뉴 -->
<div id="full_menu">
    <div class="menu_text">
        <div class="menu_text01">
            <img src="https://ifh.cc/g/sNB69z.png" alt="홈글씨">
            <div class="menu01_hover menu_hover">
                <div class="menu01_text_01">
                    <img src="https://ifh.cc/g/QxsV5b.png" alt="홈컬러글씨">
                </div>
                <div class="menu01_image">
                    <img src="https://ifh.cc/g/WaCztr.jpg" width="500px" style="opacity: 50%;" alt="메뉴홈이미지">
                </div>
            </div>
        </div>
        <div class="menu_text02">
            <img src="https://ifh.cc/g/wyoaxC.png" alt="예약글씨">
            <div class="menu02_hover menu_hover">
                <div class="menu02_text_01">
                    <a href="reservation.html">
                    <img src="https://ifh.cc/g/56hfAL.png" alt="예약컬러글씨">
                    </a>
                </div>
                <div class="menut02_image">
                    <img src="https://ifh.cc/g/WaCztr.jpg" width="500px" style="opacity: 50%;" alt="메뉴홈이미지">
                </div>
            </div>
        </div>
        <div class="menu_text03">
            <img src="https://ifh.cc/g/Q3DmaT.png" alt="용품글씨">
            <div class="menu03_hover menu_hover">
                <div class="menu03_text_01">
                    <img src="https://ifh.cc/g/fFXMxv.png" alt="용품컬러글씨">
                </div>
                <div class="menut03_image">
                    <img src="https://ifh.cc/g/WaCztr.jpg" width="500px" style="opacity: 50%;" alt="메뉴홈이미지">
                </div>
            </div>
        </div>
        <div class="menu_text04">
            <img src="https://ifh.cc/g/Pjbnqb.png" alt="Q&A글씨">
            <div class="menu04_hover menu_hover">
                <div class="menu04_text_01">
                    <img src="https://ifh.cc/g/lMwCPM.png" alt="Q&A컬러글씨">
                </div>
                <div class="menut04_image">
                    <img src="https://ifh.cc/g/WaCztr.jpg" width="500px" style="opacity: 50%;" alt="메뉴홈이미지">
                </div>
            </div>
        </div>
        <div class="menu_text05">
            <img src="https://ifh.cc/g/zMJFZD.png" alt="장바구니글씨">
            <div class="menu05_hover menu_hover">
                <div class="menu04_text_01">
                    <img src="https://ifh.cc/g/2aWS9V.png" alt="장바구니컬러글씨">
                </div>
                <div class="menut05_image">
                    <img src="https://ifh.cc/g/WaCztr.jpg" width="500px" style="opacity: 50%;" alt="메뉴홈이미지">
                </div>
            </div>
        </div>
        <div class="menu_text06">
            <img src="https://ifh.cc/g/DMYA0T.png" alt="마이페이지글씨">
            <div class="menu06_hover menu_hover">
                <div class="menu06_text_01">
                    <img src="https://ifh.cc/g/tpA4wr.png" alt="마이페이지컬러글씨">
                </div>
                <div class="menut06_image">
                    <img src="https://ifh.cc/g/WaCztr.jpg" width="500px" style="opacity: 50%;" alt="메뉴홈이미지">
                </div>
            </div>
        </div>

    </div>
</div>

<!-- 메뉴끝 -->

<!-- 햄버거 -->
<div class="hambuger">
    <div class="box">
        <div class="hambuger02">
            <img src="https://ifh.cc/g/mhGrg6.png" alt="햄버거02">
        </div>
        <div class="hambuger03">
            <img src="https://ifh.cc/g/mhGrg6.png" alt="햄버거03">
        </div>
        <div class="hambuger04">
            <img src="https://ifh.cc/g/mhGrg6.png" alt="햄버거03">
        </div>
    </div>
</div>
<!-- 햄버거끝 -->
<!-- 공용 헤더 끝 -->

<section id="container">
    <!-- section01 시작 -->
    <section id="section01">
        <div class="category">
            <div class="cate_img">
                <img src="https://ifh.cc/g/zRKsd8.jpg" alt="용품메인이미지">
            </div>
            <div class="line"></div>
        </div>
        <div class="categoryText">
            <p class="text01">ALL</p>
            <p class="text02">텐트</p>
            <p class="text03">침낭/매트</p>
            <p class="text04">테이블/의자</p>
            <p class="text05">식기</p>
            <p class="text06">기타</p>
        </div>
	</section>
</section>
<div>
	<section id="section">
				<table class="table table-hover">
					<thead>
						<tr>
							<th>상품명</th>
							<th>가격</th>
						</tr>
					</thead>
					<tbody id="list">
					</tbody>
				</table>
				<ul class="pagination">
					<li class='page-item' id="prev"><a class='page-link'>이전으로</a></li>
					<li class='page-item'><a class='page-link'></a></li>
					<li class='page-item'><a class='page-link'></a></li>
					<li class='page-item'><a class='page-link'></a></li>
					<li class='page-item'><a class='page-link'></a></li>
					<li class='page-item'><a class='page-link'></a></li>
					<li class='page-item' id="next"><a class='page-link'>다음으로</a></li>
				</ul>
			</section>
</div>
<template id="tr_template">
		<tr>
			<td>{pCode1}</td>
			<td>{pmainImg}</td>
			<td><a href="/product?pCode={pCode2}">{pName}</a></td>
			<td>{pName}</td>

		</tr>
	</template>
<footer id="footer">
        <img src="https://ifh.cc/g/NMjHLc.png" alt="푸터박스">
</footer>
</body>
</html>